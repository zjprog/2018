:figure-caption!:
:tocs!:

## 2.10.2018 ðŸš€

[quote, Edsger W. Dijkstra, On the cruelty of really teaching computer science]
____
*The usual way in which we plan today for tomorrow is in yesterday's vocabulary.*
We do so, because we try to get away with the concepts we are familiar with and
that have acquired their meanings in our past experience. Of course, the words
and the concepts don't quite fit because our future differs from our past, but
then we stretch them a little bit.
____

* Zaczynamy od przeczytania/przejrzenia
  https://github.com/uohzxela/clean-code-ruby[ðŸ› Clean Code concepts adapted for Ruby]. +
  Na wykÅ‚adzie wyjaÅ›nimy dokÅ‚adniej niektÃ³re opisanych tam
  [red]#**zaawansowanych**# rzeczy, na przykÅ‚ad co oznacza skrÃ³towiec SOLID,
  co rozumiemy przez refaktoryzacjÄ™ kodu oraz
  czy kod ktÃ³ry _smells_ to przeciwieÅ„stwo kodu ktÃ³ry jest _clean_.

* https://www.sandimetz.com/products[Literatura] â€“ na poczÄ…tek wystarczÄ… nam
  dwie ksiÄ…Å¼ki Sandi Metz i jej prezentacja z YouTube:
** https://www.youtube.com/watch?v=mpA2F1In41w[Go Ahead, Make a Mess]; zob. teÅ¼
  Joe Armstrong, one of the inventors of Erlang, https://www.youtube.com/watch?v=lKXe3HUG2l4[The Mess We're In].

.Source https://r-stylelab.com/company/blog/web-development/from-tdd-to-bdd-when-to-switch-and-how-to-apply[From TDD to BDD: When to Switch and How to Apply]
image::images/tdd-cycle.png[TDD Cycle, 575, 386]

TODO: https://discourse.omnigroup.com/t/wrap-text-around-circle/29709[Wrap text around circle].


## Note about Ruby language from Sandi Metz

**Ruby is very friendly.**
The language permits nearly anyone to create scripts to automate repetitive
tasks, and an opinionated framework like _Ruby on Rails_ puts web applications
within every programmerâ€™s reach.

The syntax of the Ruby language is so gentle that anyone blessed with the
ability to string thoughts into logical order can produce working applications.
**Programmers who know nothing about object-oriented design can be very successful in Ruby.**


## Laboratoria

### 1â€“4. Measuring Code Quality â€“ WTF, ABC Complexity

**Metrics, Duplication, Churn, Style â€“ koniec XX wieku.**

. https://github.com/AlDanial/cloc[Cloc] (counts).
. http://ruby.sadi.st/Flog.html[Flog] (ABC complexity).
. http://ruby.sadi.st/Flay.html[Flay] (structural similarities).
. https://github.com/chad/turbulence[Turbulence] (churn&complexity).
. https://docs.rubocop.org/en/latest/[RuboCop] â€“ static code analyzer (a.k.a. linter) and code formatter (style).

Zob. teÅ¼ https://www.sandimetz.com/blog/2017/9/13/breaking-up-the-behemoth[Breaking Up the Behemoth] â€“
Design Stamina Hypothesis, Procedural vs Object-Oriented Code, Churn and Complexity.

#### ABC of discovering a pain in the code

Do wyszukiwania _pain in Ruby code_ uÅ¼yjemy narzÄ™dzia
https://github.com/seattlerb/flog[Flog] â€“ the higher the
score, the more pain the code is in; zob. teÅ¼ Bryan Helmkamp,
https://codeclimate.com/blog/deciphering-ruby-code-metrics/[Deciphering Ruby Code Metrics]

.verse.rb
```ruby
def verse(n)
  "#{n == 0 ? 'No more' : n} bottle#{'s' if n != 1}" +
  " of beer on the wall, " +
  "#{n == 0 ? 'no more' : n} bottle#{'s' if n != 1} of beer.\n" +
  "#{n > 0  ? "Take #{n > 1 ? 'one' : 'it'} down and pass it around"
            : "Go to the store and buy some more"}, " +
  "#{n-1 < 0 ? 99 : n-1 == 0 ? 'no more' : n-1} bottle#{'s' if n-1 != 1}"+
  " of beer on the wall.\n"
end
```

```sh
flog -ad verse.rb # --all --details
    36.2: flog total
    36.2: flog/method average

    36.2: main#verse                       verse.rb:1-8
    15.2:   branch
     7.0:   +
     6.5:   -
     5.3:   ==
     5.2:   !=
     4.1:   lit_fixnum
     3.3:   >
     1.4:   <
```

See http://www.methods.co.nz/asciidoc/chunked/ch10.html[Chapter 10. Text Formatting] for examples
of colored, line-through formatting.


### 5â€“7. Following Rules

#### No rules KATA.

* https://github.com/emilybache/GildedRose-Refactoring-Kata[Gilded Rose Refactoring Kata]
** http://iamnotmyself.com/2011/02/13/refactor-this-the-gilded-rose-kata/[Refactor This: The Gilded Rose Kata]
** https://bettercodehub.com[https://bettercodehub.com]

#### Sample rules to follow.

Sandi Metz.
  https://www.youtube.com/watch?v=npOGOmkxuio[Rules], Baruco 2013. No more than:

. 100 lines per class
. 5 lines per method
. 3 parameters per method

Corey Haines.
  http://www.r-5.org/files/books/computers/languages/ruby/main/Corey_Haines-The_Four_Rules_of_Simple_Design-EN.pdf[Understanding the 4 Rules of Simple Design]:

. Tests Pass
. Expresses Intent
. No Duplication (DRY)
. Small

https://pl.wikipedia.org/wiki/SOLID_(programowanie_obiektowe)[SOLID] â€“
  coined by Michael Feathers and popularized by Robert Martin:

. _**S**ingle Responsibility_,
. _**O**pen-Closed_,
. _**L**iskov Substitution_,
. _**I**nterface Segregation_,
. _**D**ependency Inversion_.

Andy Hunt, Dave Thomas.
https://en.wikipedia.org/wiki/Don%27t_repeat_yourself[DRY (Donâ€™t Repeat Yourself)] â€“

https://pl.wikipedia.org/wiki/Prawo_Demeter[LoD (the Law of Demeter)],
  the DemeterÂ project at Northeastern University

Refactoring rules by S. Metz:

. Make one change on just one line.
. Run the tests.
. If they fail, undo the change.
. Try again with another change to just one line of the code.

Our rules?

. Replace Conditional with Polymorphism
. https://stackoverflow.com/questions/1337565/avoiding-if-statements[Avoiding If Statements]


### 8â€“12. Code Treatment

[quote, John Searle (philosopher)]
____
People will do almost anything rather than think.
____

{nbsp} +

Wyszukujemy i naprawiamy _problemy w kodzie_.

**Code smells, refactorings â€“ poczÄ…tek XXI wieku, Kent Beck.**

UruchomiÄ‡ https://github.com/whitesmith/rubycritic[RubyCritics] â€“ a Ruby code quality reporter â€“
na wiÄ™kszym projekcie napisanym w jÄ™zyku Ruby.

#### Code smell of the week

Programu **reek** moÅ¼na uÅ¼yÄ‡ do wypisania â€žzapachÃ³wâ€ w projekcie napisanym w jÄ™zyku Ruby:

```sh
reek -f json KATALOG | jq .[].documentation_link | sort | uniq -c | sort -n
```
JeÅ›li katalog zawiera nie tylko pliki z kodem w jÄ™zyku Ruby, to modyfikujemy nieco to polecenie,
na przykÅ‚ad tak:
```sh
find lib -name '*.rb' | xargs reek -f json  | jq .[].documentation_link | sort | uniq -c | sort -n
```

Tutaj jest **link:refactorings.adoc[oficjalna lista code smells i refaktoryzacji]**
dla jÄ™zyka Ruby i Java.
ZnaleÅºÄ‡ trzy najczÄ™Å›ciej wystÄ™pujÄ…ce oficjalne zapachy w jakimÅ› wiÄ™kszym projekcie Ruby.

Na ile linijek kodu, Å›rednio, wypada jeden zapach.


### WykÅ‚ady â€“ prezentacje projektÃ³w na egzamin

Lista prezentacji, **stacjonarne**:

.  8.01.2019, godz. 12.15â€“13.45, a. 2.
.. M.M. & M.P. (Java)
. 16.01.2019, godz. 12.15â€“13.45, a. 2.
.. One Direction (Java)
. 22.01.2019, godz. 12.15â€“13.45, a. 2.
.. RT (Python)

Lista prezentacji, **niestacjonarne**:

. 12.01.2019, godz. 13.50â€“15.20, a. 2.
.. Sto Twarzy Grzybiarzy (C#)
. 19.01.2019, godz. 13.50â€“15.20, a. 2.
.. AMD.GIT (JavaScript)
. 26.01.2019, godz. 13.50â€“15.20, a. 2.

{nbsp} +

PrzykÅ‚adowe refaktoryzacje:

* Katrina Owen.
https://www.youtube.com/watch?v=J4dlF0kcThQ[Therapeutic Refactoring].
* Sam Livingston-Gray.
https://www.rubytapas.com/2016/12/05/refactoring-ruby-dry-domain-models-struct-table/[DRY up your domain models using a struct table].


## Zapoznajemy siÄ™ z cyklem TDD

ZakÅ‚adamy konto na portalu https://exercism.io[Exercism].
NastÄ™pnie wybieramy **tracks** z jÄ™zykiem obiektowym i przerabiamy
Ä‡wiczenia (10+).
